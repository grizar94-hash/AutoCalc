<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∞–≤—Ç–æ –∏–∑ –ö–æ—Ä–µ–∏</title>

<!-- Open Graph -->
<meta property="og:type" content="website" />
<meta property="og:title" content="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∞–≤—Ç–æ –∏–∑ –ö–æ—Ä–µ–∏" />
<meta property="og:description" content="–†–∞—Å—Å—á–∏—Ç–∞–π –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å ¬´–ø–æ–¥ –∫–ª—é—á¬ª –≤ —Ä—É–±–ª—è—Ö –∏ USDT." />
<meta property="og:url" content="https://grizar94-hash.github.io/AutoCalc/" />
<meta property="og:image" content="https://grizar94-hash.github.io/AutoCalc/share.png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />

<link rel="icon" href="icon.png" type="image/png" />
<link rel="apple-touch-icon" href="icon.png" />
<link rel="manifest" href="manifest.json" />
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />

<!-- jsPDF + html2canvas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
  body {
    font-family: 'Roboto', sans-serif;
    background: #f0f2f5;
    padding: 20px;
    overflow-x: hidden;
  }
  .wrap { max-width: 720px; margin: 0 auto; }
  h2 { text-align: center; color: #0b69ff; margin-bottom: 20px; }
  .section {
    padding: 20px; margin-bottom: 15px; border-radius: 12px; color: #fff;
    box-shadow: 0 4px 10px rgba(0,0,0,.1); transition: background .3s;
  }
  .korea { background: #4fc3f7; }
  .currency { background: #26a69a; }
  .russia { background: #81c784; }
  .section label { display: block; margin-top: 10px; font-weight: bold; }
  input {
    width: 100%; padding: 10px; margin-top: 5px; border-radius: 8px; border: none;
    font-size: 16px;
  }
  .insurance-row {
    display: flex; align-items: center; gap: 10px;
    margin: 12px 0 4px; background: #f7f7f8; border: 1px solid #e5e7eb;
    border-radius: 10px; padding: 10px 12px; box-shadow: 0 4px 10px rgba(0,0,0,.1);
  }
  .insurance-row input { width: 20px; height: 20px; }
  .insurance-row label { flex: 1; font-weight: 600; line-height: 1.3; }
  button {
    width: 100%; padding: 14px; margin-top: 15px; font-size: 18px;
    border: none; border-radius: 10px; cursor: pointer;
    background: #0b69ff; color: white; font-weight: bold;
    transition: background 0.2s; box-shadow: 0 4px 10px rgba(0,0,0,.1);
  }
  button:hover { background:#0756d1; }
  button.clear { background:#ccc; color:#111; }
  button.pdf { background:#0b69ff; color:#fff; }
  .result {
    margin-top: 20px; padding: 20px; border-radius: 12px;
    background: #fff3e0; font-size: 18px; box-shadow: 0 4px 10px rgba(0,0,0,.1);
  }
  .result p { margin: 10px 0; font-weight: bold; font-size: 18px; }
  hr { border: 0; border-top: 2px dashed #ccc; margin: 10px 0; }
</style>
</head>
<body>
<main class="wrap">

<h2>üöó –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–æ—Å—Ç–∞–≤–∫–∏ –∞–≤—Ç–æ –∏–∑ –ö–æ—Ä–µ–∏</h2>

<div class="section korea" id="blockKorea">
  <h3>üá∞üá∑ –ö–æ—Ä–µ—è</h3>
  <label>–¶–µ–Ω–∞ –∞–≤—Ç–æ (‚Ç©): <input type="number" id="priceKrw" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ü–µ–Ω—É –∞–≤—Ç–æ"></label>
  <label>–†–∞—Å—Ö–æ–¥—ã –≤ –ö–æ—Ä–µ–µ –≤–∫–ª—é—á–∞—è —Ñ—Ä–∞—Ö—Ç (‚Ç©): <input type="number" id="expensesKrw" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–∞—Å—Ö–æ–¥—ã"></label>
</div>

<div class="section currency" id="blockCurrency">
  <h3>üí± –ö—É—Ä—Å –≤–∞–ª—é—Ç</h3>
  <label>USDT ‚Üí ‚ÇΩ: <input type="number" id="rubUsdt" placeholder="–°–∫–æ–ª—å–∫–æ —Ä—É–±–ª–µ–π –∑–∞ 1 USDT" step="0.1"></label>
  <label>USDT ‚Üí ‚Ç©: <input type="number" id="usdtKrw" placeholder="–°–∫–æ–ª—å–∫–æ –≤–æ–Ω –∑–∞ 1 USDT" step="0.1"></label>
</div>

<div class="section russia" id="blockRussia">
  <h3>üá∑üá∫ –†–æ—Å—Å–∏—è</h3>
  <label>–ü–æ—à–ª–∏–Ω–∞ –∏ —Å–±–æ—Ä—ã (‚ÇΩ): <input type="number" id="dutyRub" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä 150000"></label>
  <label>–¢–∞–º–æ–∂–µ–Ω–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∏ —É—Å–ª—É–≥–∏ –±—Ä–æ–∫–µ—Ä–∞ (‚ÇΩ): <input type="number" id="brokerRub" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä 70000"></label>
  <label>–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –†–æ—Å—Å–∏–∏ (‚ÇΩ): <input type="number" id="deliveryRub" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä 50000"></label>
</div>

<div class="insurance-row">
  <input type="checkbox" id="insuranceCheck" />
  <label for="insuranceCheck">–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∫—É 0,3% –æ—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Å—É–º–º—ã</label>
</div>

<button onclick="calculate()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
<button class="clear" onclick="clearAll()">–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª—è</button>
<button class="pdf" onclick="downloadPDF()">üìÑ –°–∫–∞—á–∞—Ç—å PDF-–æ—Ç—á—ë—Ç</button>

<div class="result" id="result"></div>
</main>

<script>
// –ê–Ω–∏–º–∞—Ü–∏—è —á–∏—Å–µ–ª
function animateValue(id, start, end, duration) {
  const el=document.getElementById(id); const rng=end-start; let t0=null;
  function step(ts){ if(!t0) t0=ts; const p=Math.min(1,(ts-t0)/duration);
    const v=Math.floor(start+rng*p);
    el.textContent=v.toLocaleString('ru-RU')+' ‚ÇΩ';
    if(p<1) requestAnimationFrame(step); else el.textContent=end.toLocaleString('ru-RU')+' ‚ÇΩ';
  }
  requestAnimationFrame(step);
}

function calculate(){
  const priceKrw=+document.getElementById('priceKrw').value||0;
  const expensesKrw=+document.getElementById('expensesKrw').value||0;
  const rubUsdt=+document.getElementById('rubUsdt').value||0;
  const usdtKrw=+document.getElementById('usdtKrw').value||0;
  const dutyRub=+document.getElementById('dutyRub').value||0;
  const brokerRub=+document.getElementById('brokerRub').value||0;
  const deliveryRub=+document.getElementById('deliveryRub').value||0;
  const insuranceOn=document.getElementById('insuranceCheck').checked;

  const totalKrw=priceKrw+expensesKrw;
  const rubNeeded=usdtKrw?(totalKrw/usdtKrw)*rubUsdt:0;
  const preFinal=rubNeeded+dutyRub+brokerRub+deliveryRub;
  const insurance=insuranceOn?preFinal*0.003:0;
  const finalSum=preFinal+insurance;

  document.getElementById('blockKorea').style.background='#29b6f6';
  document.getElementById('blockRussia').style.background='#66bb6a';
  document.getElementById('result').style.background='#ffe0b2';

  document.getElementById('result').innerHTML=`
    <p>üí∞ –í –ö–æ—Ä–µ–µ: <span id="valKorea">0 ‚ÇΩ</span></p>
    <p>üí∞ –í –†–æ—Å—Å–∏–∏: <span id="valRussia">0 ‚ÇΩ</span></p>
    ${insuranceOn?`<p>üõ°Ô∏è –°—Ç—Ä–∞—Ö–æ–≤–∫–∞: <span id="valInsurance">0 ‚ÇΩ</span></p>`:''}
    <hr>
    <p>üèÅ –ü–æ–¥ –∫–ª—é—á: <span id="valFinal">0 ‚ÇΩ</span></p>
  `;

  animateValue('valKorea',0,Math.round(rubNeeded),900);
  animateValue('valRussia',0,Math.round(dutyRub+brokerRub+deliveryRub),900);
  if(insuranceOn) animateValue('valInsurance',0,Math.round(insurance),900);
  animateValue('valFinal',0,Math.round(finalSum),1100);
}

function clearAll(){
  ['priceKrw','expensesKrw','rubUsdt','usdtKrw','dutyRub','brokerRub','deliveryRub']
    .forEach(id=>document.getElementById(id).value='');
  document.getElementById('insuranceCheck').checked=false;
  document.getElementById('result').innerHTML='';
  document.getElementById('blockKorea').style.background='#4fc3f7';
  document.getElementById('blockRussia').style.background='#81c784';
}

// PDF –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
async function downloadPDF(){
  const resBlock=document.getElementById('result');
  if(!resBlock || !resBlock.innerText.trim()){
    alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ä–∞—Å—á—ë—Ç.');
    return;
  }
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ unit:'mm', format:'a4' });

  const page=document.createElement('div');
  page.style.cssText="position:fixed;left:-9999px;top:0;width:794px;background:#fff;color:#000;font-family:Arial;padding:20px;";

  page.innerHTML=`
    <div style="height:10px;background:#111;width:100%;margin-bottom:10px;"></div>
    <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:20px;">
      <img src="logo.png" style="height:60px;object-fit:contain;" />
      <div style="text-align:right;font-size:12px;line-height:1.5;">
        <strong>Harmex</strong><br>
        ÏÇ¨ÏóÖÏûêÎì±Î°ùÎ≤àÌò∏: 749-11-02981<br>
        Tel: +82 10 3056 0903<br>
        Email: annamoloz95@gmail.com<br>
        Address: 201, 42 Hambak-ro84beon-gil,<br>
        &nbsp;&nbsp;&nbsp;&nbsp;Yeonsu-dong, Yeonsu-gu, Incheon, South Korea<br>
        Director: Molozhavaia Anna
      </div>
    </div>
    <h2 style="text-align:center;margin:0 0 10px;font-size:18px;">–û—Ç—á—ë—Ç –ø–æ —Ä–∞—Å—á—ë—Ç—É –∞–≤—Ç–æ–º–æ–±–∏–ª—è –∏–∑ –ö–æ—Ä–µ–∏</h2>
    <div style="text-align:center;font-size:12px;margin-bottom:12px;">–î–∞—Ç–∞: ${new Date().toLocaleDateString('ru-RU')}</div>
    <div style="border-top:1px solid #000;margin:10px 0;"></div>
    <div style="font-size:14px;line-height:1.6;">${resBlock.innerText.replace(/\n/g,'<br>')}</div>
  `;

  document.body.appendChild(page);

  const canvas=await html2canvas(page,{scale:2});
  const imgData=canvas.toDataURL('image/png');
  const pw=doc.internal.pageSize.getWidth();
  const ph=doc.internal.pageSize.getHeight();
  const ratio=canvas.height/canvas.width;
  const ih=pw*ratio;

  doc.addImage(imgData,'PNG',0,0,pw,ih);
  doc.save('calc-report.pdf');

  document.body.removeChild(page);
}
</script>
</body>
</html>
